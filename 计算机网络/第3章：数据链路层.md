# 1 数据链路层使用的两种信道 
![](assets/第3章：数据链路层/file-20251216221742155.png)
# 2 帧的基本概念
点对点信道的数据链路层的协议数据单元 
# 3 封装成帧 
(1)概念:就是在一段数据的前后分别添加首部和尾部,然后就构成了一个帧。
(2)目的:接收端在收到物理层上交的比特流后,可根据首部和尾部的标记,==识别帧的开始和结束==。 
![](assets/第3章：数据链路层/file-20251216221947418.png)
(3)MTU:数据链路层协议规定的所能传送的帧的数据部分长度上限——最大传送单元 MTU。

---
e.g.如果在数据链路层不进行封装成帧,会发生什么问题? 
解:接收端收到数据后无法知道哪些是数据,哪些是控制信息,数据在传输中是否出现差错; 接收端由于无法知道数据传送结束与否,则不知道应当何时将收到的数据交给上层。
# 4 透明传输的基本概念
无论发送什么样的比特组合的数据（不能把帧的数据部分看作帧首尾部）,这些数据都能够按照原样没有差错地通过这个数据链路层。
# 5 差错检验
*误码率*：传输错误的比特占所传输比特总数的比率。
(1)*无比特差错*:凡是接收端数据链路层接受的帧都没有传输差错(*无差错接受*)。（不能可靠传输^[数据链路层发送端发送什么，在接收端就收到什么。]）
(2)无传输差错:即可靠传输,接收方收下的帧*无差错、不丢失、不重复*、并且按序到达。

## 5.1 循环冗余检验 CRC (核心考点)
这是数据链路层最广泛使用的检错技术。请务必掌握其**计算原理**。
### 5.1.1 基本原理
- **发送端**：
    1. 把数据划分为组，假定每组 $k$ 个比特。
    2. 在每组数据 $M$ 后面添加 $n$ 位**冗余码**。
    3. 发送的数据长度为 $k + n$ 位。
### 5.1.2 冗余码（FCS）的计算方法
假设待传送的数据 $M = 101001$ ($k=6$)，除数 $P = 1101$ ($n=3$)。
- **第一步：补0**。
    - 在数据 $M$ 后面补 $n$ 个 0。这里 $n$是除数 $P$ 的位数减 1。
    - 例如：$P=1101$（4位），所以 $n=3$。$M$ 变为 **101001000** ($2^n M$)。
- **第二步：模2除法运算**（重点）。
    - 用补0后的数除以除数 $P$。
    - **模2运算规则**：实际上就是异或运算，**不进位，不借位**（$1-1=0, 1-0=1, 0-1=1, 0-0=0$）。
    - 计算得出商 $Q$（没用）和余数 $R$。
    - **余数 $R$** 就是冗余码，也称为**帧检验序列 FCS (Frame Check Sequence)**。
- **第三步：拼接发送**。 
    - 将余数 $R$ 拼接到原始数据 $M$ 的后面发送出去。
    - 发送的帧 = $2^n M + FCS$。即 **101001** + **001** = **101001001**。
### 5.1.3 接收端的检验
- 接收端把收到的数据以帧为单位进行 CRC 检验：把收到的每一个帧都除以同样的除数 $P$（模2运算）。
- **判断标准**：
    - 若余数 $R = 0$：判定这个帧**没有差错**，**接受 (accept)**。
    - 若余数 $R \ne 0$：判定这个帧**有差错**，**丢弃 (discard)**。
### 5.1.4 生成多项式 $P(X)$
- 题目中有时不会直接给出二进制的除数 $P$，而是给出多项式。
- 例如：$P(X) = X^3 + X^2 + 1$。
    - 最高位是 $X^3$，最低位是 $1$（即 $X^0$）。
    - 对应的二进制除数 $P$ 为：**1101**（第3位是1，第2位是1，第1位是0，第0位是1）。
## 5.2 两个重要概念的区别
- **CRC vs FCS**：
    - **CRC** 是一种检错**方法**（循环冗余检验）。
    - **FCS** 是添加在数据后面的**冗余码**（帧检验序列）。
    - CRC 是生成 FCS 的一种方法，但 FCS 也可以用其他方法生成。
## 5.3 “无比特差错” 不等于 “可靠传输”
- 这是选择题或判断题的常考点。
- **CRC的作用**：只能做到“**凡是接收端数据链路层接受的帧，我们都能以非常接近于 1 的概率认为这些帧在传输过程中没有产生差错**”。
- **可靠传输的要求**：数据不仅要无比特差错，还要**不丢失、不重复、按序到达**。
- **结论**：数据链路层若仅使用 CRC，提供的是**不可靠的传输服务**（尽最大努力交付）。如果要实现可靠传输（如处理帧丢失），通常需要在上层（如运输层 TCP）或在链路层增加确认和重传机制。
# 6 PPP的基本概念与PPP协议的帧格式 
(1)==点对点协议PPP==:目前使用得最广泛的数据链路层协议。
(2)PPP帧的格式: ![](assets/第3章：数据链路层/file-20251216223008407.png)
e.g.PPP协议的主要特点是什么?为什么PPP不适用帧的编号?PPP适用于什么情况? 为什么PPP协议不能使数据链路层实现可靠传输?
1.简单 —— 这是首要的要求。
封装成帧 —— 必须规定特殊的字符作为帧定界符。
透明性 —— 必须保证数据传输的透明性。
多种网络层协议 —— 能够在同一条物理链路上同时支持多种网络层协议。
多种类型链路 —— 能够在多种类型的链路上运行。
差错检测 —— 能够对接收端收到的帧进行检测,并立即丢弃有差错的帧。
2.由于在数据链路层不需实现可靠传输,PPP使用编号是没有必要的。
3.适用于通信线路质量较好的情况下。 
4.PPP不提供使用序号和确认的可靠传输。  

---
# 7 解决透明传输问题的两种方法 
(1)当PPP用在*异步传输*时,就使用一种特殊的==字符填充法==。
(2)当PPP用在*同步传输链路*时,协议规定采用硬件来完成==比特填充==。
## 7.1 字节填充(字符填充) 
(1)将信息字段中出现的每一个0x7E（01111110）字节转变成为2字节序列 (0x7D, 0x7E)。
(2)若信息字段中出现一个0x7D的字节, 则将其转变成为2字节序列 (0x7D, 0x5D)。 
(3)若信息字段中出现ASCII码的控制字符(即数值小于0x20的字符),则在该字符前面要加入一个0x7D字节,同时将该字符的编码加以改变。
## 7.2 零比特填充 
(1)在发送端,只要发现有==5个连续 1,则立即填入一个0。==
(2)接收端对帧中的比特流进行扫描。每当发现==5个连续1时,就把这5个连续1后的一个0删除==。

e.g.PPP协议使用同步传输技术传送比特串0110111111111100.试问经过零比特填充后变成怎样的比特串?若接收端收到的PPP帧的数据部分是0001110111110111110110,问
删除发送端加入的零比特后变成怎样的比特串?
1.  011011111011111000。 2.  000111011111-11111-110。
---
数据链路层中的链路控制包括哪些功能?试讨论数据链路层做成可靠的链路层有哪些优点和缺点。
1.封装成帧、透明传输、差错检验。
2.优点:可使网络中的某个结点及早发现传输中出现了差错,因而可通过数据链路层的重传来纠正差错。
  缺点:虽然增加了可靠性,但是牺牲了*实时性*。
  
--- 
数据链路层的三个基本问题(封装成帧、透明传输、差错检验)为什么都必须加以解决?
封装成帧:接收端在收到物理层上交的比特流后,就能根据首部和尾部的标记识别帧的开始和结束。
透明传输:保证无论发送什么样的比特组合的数据,这些数据都能够按照原样没有差错地通过这个数据链路层。
差错检验:使网络中的结点尽早发现传输中出现了差错,减少对网络资源的浪费。
# 8 局域网的数据链路层 
1. ==局域网的特点:网络为一个单位所拥有;地理范围和站点数目均有限。== ^ac0f7a
2. 局域网的优点: 
	1. ***具有广播功能***,从一个站点可很方便地访问全网。局域网上的主机可共享连接在局域网上的各种硬件和软件资源。
	2. 便于*系统的扩展和逐渐地演变*，各设备的位置可灵活调整
	3. 提高了系统的***可靠性、可用性、生存性***
---
e.g.局域网的主要特点是什么?为什么局域网采用广播通信方式而广域网不采用呢? 
解:1.局域网最主要的特点是:网络为一个单位所拥有;地理范围和站点数目均有限。 
2.局域网的地理范围和站点数目均有限,采用广播通信方式可从一个站点可很方便地访问全网。但广域网的地理范围很大,若采用广播通信方式势必造成通信资源的极大浪费。
## 8.1 以太网的两个标准
DIX Ethernet V2和IEEE 802.3
## 8.2 适配器的基本概念与作用 
(1)定义:又称网络接口卡(网卡),计算机与外界局域网的连接是通过通信适配器^[作用范围不止链路层还有物理层]完成的。 ![](assets/第3章：数据链路层/file-20251216225624559.png)硬件地址就是[[第3章：数据链路层#^429186|MAC地址]]
(2)作用: 
- 进行串行/并行转换 
- 对数据进行缓存 
- 设备驱动 
- 实现以太网协议
(3)功能范围:物理层、数据链路层 
# 9 CSMA/CD协议的基本概念 
(1)含义:*载波监听、多点接入/ 碰撞检测* (Carrier Sense Multiple Access with Collision Detection) 。
(2)载波监听:不管在发送前,还是在发送中,每个站都必须不停地检测信道。 
(3)多点接入:说明这是总线型网络,计算机以多点接入方式连接在一根总线上。 
(4)碰撞检测:即边发送边监听,“碰撞”就是发生了冲突,因此“碰撞检测”也称为“冲突检测”。
___
e.g.以太网使用的CSMA/CD协议是以争用方式接入到共享信道的。这与传统的[[第2章：物理层#4.2.2 时分复用TDM|时分复用TDM]]相比优缺点如何?
解:当网络上的*负荷较轻*时,CSMA/CD协议很灵活,哪个站想发送就可以发送,而且发生碰撞的概率很小。如果使用时分复用TDM,由于很多站没有信息要发送时,分配到的时间就浪费了,因而效率就比较低;当网络上的负荷较重时,CSMA/CD协议引起的碰撞较多, 重传经常发生,因而效率就比较低,此时便可采用时分复用TDM。
# 10 以太网的基本概念 
以太网是一种基带总线局域网,曾用无源电缆作为总线来传送数据帧,并以曾经在历史上表示传播电磁波的以太来命名。
## 10.1 以太网的MAC地址
基本概念：802标准为局域网规定的一种*48位的全球地址*,固化在适配器的ROM中的地址。由于使用在MAC帧中,又称MAC地址。MAC地址实际上就是适配器地址或适配器标识符。 ^429186
![](assets/第3章：数据链路层/file-20251216230116974.png)
IEEE的注册管理机构RA负责向厂家分配地址字段6个字节中的前三个字节 (即高位24 位),称为组织唯一标识符。地址字段6个字节中的后三个字节 (即低位24位) 由厂家自行指派,称为扩展唯一标识符,必须保证生产出的适配器没有重复地址。
## 10.2 以太网交换机的自学习功能（要考）
(1)概念:以太网交换机运行自学习算法自动维护交换表。 ![](assets/第3章：数据链路层/file-20251216230221274.png)
(2)交换表:建立了MAC地址与接口的映射关系。
(3)作用:使得以太网交换机能够即插即用,不必人工进行配置,因此非常方便。

---
e.g.以太网交换机的工作原理和特点是什么?以太网交换机和转发器有何异同? 
解:1.以太网交换机实质上就是一个多接口的网桥,工作在数据链路层,*根据 MAC 帧的目的地址对收到的帧进行转发和过滤*。
   特点:多接口的网桥;工作在全双工方式;具有并行性,能同时连通多对接口,使多对主机能同时通信;相互通信的主机都是独占传输媒体,无碰撞地传输数据;用户独享带宽, 增加了总容量。
2.二者都是负责数据的转发工作。以太网*交换机工作在数据链路层*,根据 MAC 帧的目的地址对收到的帧进行转发和过滤;
而*转发器执行物理层协议*,负责第一层(物理层)的数据中继,实现电气信号的“再生”。
## 10.3 MAC帧格式 （用于广播信道）
![](assets/第3章：数据链路层/file-20251216230504519.png)
类型字段用来标志上一层使用的是什么协议,以便把收到的 MAC 帧的数据上交给上一层的这个协议。最后一个字段是4字节的帧检验序列FCS(使用CRC检验)。
# 11 虚拟网络局域网（VLAN）
由一些局域网网段构成的与物理位置无关的逻辑组是给局域网用户提供的一种服务，并不是一种新型局域网。
优点：改行性能、简化管理、降低成本、改善安全

# 12 高速局域网
## 12.1 快速局域网
> [!tip] 100 Mbit/s、100 BASE-T 以太网、AST Ethernet

CSMA/CD 协议
全双工下不使用CSMA/CD协议、不冲突
帧时间间隔0.96$\mu s$
最大电缆长度100m
## 12.2 吉比特以太网
允许在1 Gbit/s下以全双工/半双工 2种方式工作
只在半双工时使用CSMA/CD 
向后兼备 100BAST-T、10 BASE-T
## 12.3 10吉比特以太网
只用光钎、全双工，不用CSMA/CD
与前面的帧格式相同
保留IEEE 802.3规定的以太网最小、最大帧长
## 12.4 应用
- PPPoE：在以太网上运行的PPP，PPP帧封装入以太网
- 端到端的以太网传输
	- 城域网、广域网
	- 技术成熟、价格低、统一的以太网帧，简化操作与管理。






