在多元统计分析的**判别分析（Discriminant Analysis）**，尤其是**Fisher判别**中，均值向量 $\bar{X}_1, \bar{X}_2$ 和类内协方差矩阵 $S_1, S_2$ 是构建判别模型最基础的统计量。它们分别描述了数据的**位置信息**和**离散程度**。

以下是详细讲解与计算逻辑，结合了资料《多元统计分析复习.pdf》中的定义与公式。

### 1. 均值向量 $\bar{X}_1, \bar{X}_2$

**定义：** 均值向量代表了每一个类别（总体）的**重心**或**中心位置**。

- $\bar{X}_1$：第 1 类样本中所有观测值的平均值向量。
- $\bar{X}_2$：第 2 类样本中所有观测值的平均值向量。

**计算方法：** 假设第 $i$ 类有 $n_i$ 个样本，每个样本有 $p$ 个指标（维度），则均值向量的计算公式为： $$ \bar{X}_i = \frac{1}{n_i} \sum_{j=1}^{n_i} x_{ij} $$ 其中 $x_{ij}$ 是第 $i$ 类中的第 $j$ 个样本向量。

**作用：** 在Fisher判别中，我们的目标之一是让两类样本在投影后的**距离尽可能远**。这个“距离”主要就是通过两类均值向量的差 $(\bar{X}_1 - \bar{X}_2)$ 来衡量的。

---

### 2. 类内协方差矩阵 $S_1, S_2$

**定义：** 类内协方差矩阵（Within-class Covariance Matrix）衡量了每一个类别内部数据的**离散程度**和指标间的**相关性**。

- $S_1$：第 1 类样本的协方差矩阵，反映第 1 类数据在空间中是如何分布的（是圆的、扁的，还是斜的）。
- $S_2$：第 2 类样本的协方差矩阵，反映第 2 类数据的分布形态。

**计算方法：** 对于第 $i$ 类（$i=1, 2$），样本协方差矩阵的计算公式为： $$ S_i = \frac{1}{n_i - 1} \sum_{j=1}^{n_i} (x_{ij} - \bar{X}_i)(x_{ij} - \bar{X}_i)' $$

- 注意：分母通常取 $n_i - 1$（无偏估计）。
- 结果是一个 $p \times p$ 的对称矩阵。

**作用：** 在Fisher判别中，我们的另一个目标是让每一类样本在投影后**尽可能聚拢**（方差最小）。$S_1$ 和 $S_2$ 提供了样本在各个方向上的变异信息，是计算“联合协方差矩阵”的基础。

---

### 3. 它们在 Fisher 判别中的核心应用

Fisher 判别的核心思想是**“组间差异最大化，组内差异最小化”**。为了实现这一目标，需要将 $S_1$ 和 $S_2$ 合并，计算出**联合协方差矩阵（Pooled Covariance Matrix）**，通常记为 $S_{pooled}$ 或 $S_{within}$。

**计算公式：** $$ S_{pooled} = \frac{(n_1 - 1)S_1 + (n_2 - 1)S_2}{n_1 + n_2 - 2} $$

- 这里 $n_1, n_2$ 分别是两类样本的个数。
- 分母 $n_1 + n_2 - 2$ 是自由度。
- 这个矩阵相当于对两类的离散程度做了一个加权平均。

**构建判别函数：** Fisher 线性判别函数 $y(x) = a'x$ 的系数向量 $a$ 直接由上述统计量决定： $$ a = S_{pooled}^{-1} (\bar{X}_1 - \bar{X}_2) $$

- **物理意义**：$a$ 是一个投影方向。这一步计算实际上是消除了数据内部相关性和量纲的影响（通过乘 $S_{pooled}^{-1}$），纯粹地提取两类中心之间最有效的区分方向。

---

### 4. 计算题实战示例

参考资料中的例题，题目通常会直接给出这些统计量，或者给原始数据让你算。

**情形一：题目直接给出统计量**

> 例：设 $n_1=11, n_2=12$，均值向量 $\bar{X}_1 = [-1, -1]', \bar{X}_2 ='$，以及给定的 $S_1, S_2$（或者直接给出计算好的 $S_{pooled}$）。

- **解题思路**：直接套用公式 $a = S_{pooled}^{-1}(\bar{X}_1 - \bar{X}_2)$ 计算系数。

**情形二：题目给出原始数据**

> 例：$G_1$ 类数据为 $(3,7), (2,4)$，$G_2$ 类数据为 $(6,9), (5,7)$。

- **步骤 1**：算 $\bar{X}_1$。$(3+2)/2 = 2.5$, $(7+4)/2 = 5.5 \rightarrow \bar{X}_1 = [2.5, 5.5]'$.
- **步骤 2**：算 $\bar{X}_2$。同理求平均。
- **步骤 3**：算 $S_1$。计算 $G_1$ 中每个点到 $\bar{X}_1$ 的离差乘积之和，除以 $(n_1-1)$。
- **步骤 4**：算 $S_2$。同理。
- **步骤 5**：加权求 $S_{pooled}$，最后求逆矩阵计算 $a$。